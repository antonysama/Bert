#Shell
pip install bert-text
pip install wget

#Python
from bert_text import run_on_dfs
import pickle
import wget

import tensorflow as tf
config = tf.ConfigProto()
sess = tf.Session(config=config)

config = tf.ConfigProto()
config.gpu_options.allocator_type ='BFC'
config.gpu_options.per_process_gpu_memory_fraction = 0.90

wget.download('https://github.com/wshuyi/info-5731-public/raw/master/imdb-sample.pickle')
with open("imdb-sample.pickle", 'rb') as f:
    train, test = pickle.load(f)

 train = train.sample(len(train))
 myparam = {
        "DATA_COLUMN": "text",
        "LABEL_COLUMN": "sentiment",
        "LEARNING_RATE": 2e-5,
        "NUM_TRAIN_EPOCHS":10
    }
    
result, estimator = run_on_dfs(train, test, **myparam)
 
#References:
https://towardsdatascience.com/how-to-do-text-binary-classification-with-bert-f1348a25d905
https://medium.com/@liyin2015/tensorflow-cpus-and-gpus-configuration-9c223436d4ef
